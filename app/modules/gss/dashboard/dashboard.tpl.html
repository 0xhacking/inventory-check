<div class="status-dashboard">
  <cs-page-sub-header>
    <cs-page-sub-header-left>
      <h2 translate="gss.dashboard"></h2>
    </cs-page-sub-header-left>
  </cs-page-sub-header>

  <div class="incident-section medium-10 center-block">
    <cs-page-sub-header>
      <cs-page-sub-header-left>
        <h3 translate="gss.incidents"/>
      </cs-page-sub-header-left>
      <cs-page-sub-header-right>
        <button class="btn btn-primary" ng-click="goToNewIncidentPage()" translate="gss.incidentsPage.newIncidentBtn">
        </button>
      </cs-page-sub-header-right>
    </cs-page-sub-header>

    <div ng-if="!dashboardCtrl.showList" class="no-incident-notification">
      <h6 translate="gss.incidentsPage.noIncidentContent1"></h6>
      <span translate="gss.incidentsPage.noIncidentContent2"></span>
      <a translate="gss.incidentsPage.noIncidentContentLink" ng-click="goToNewIncidentPage()"></a>
    </div>

    <ul ng-if="dashboardCtrl.showList" class="incidents-list">
      <li ng-repeat="incident in dashboardCtrl.incidentList | orderBy:'-incident.lastModifiedTime':true">
        <div ng-if="incident.status!='resolved'">
          <span class="pull-left">{{ incident.incidentName }}</span>

          <a class="pull-right" translate="gss.updateIncident"
             ui-sref="gss.under.construction( { incidentName:incident.incidentName, incidentId:incident.incidentId } )"></a>
        </div>

        <div ng-if="incident.status!='resolved'">
          <h6><strong>{{ incident.status }}</strong></h6>
          <h6>{{ incident.message }}</h6>
          <h6 class="body-small">{{ incident.lastModifiedTime | date: "medium" }}</h6>
        </div>
      </li>
    </ul>
  </div>

  <div class="component-section medium-10 center-block">
    <cs-page-sub-header>
      <cs-page-sub-header-left>
        <h3 translate="gss.componentStatuses"></h3>
      </cs-page-sub-header-left>
    </cs-page-sub-header>

    <ul ng-if="dashboardCtrl.components.length" class="components-list">
      <li ng-repeat="component in dashboardCtrl.components | orderBy: 'position'">
        <div class="row showgrid" ng-init="hide = false">
          <span class="component-name columns medium-5" ng-click="hide = !hide">{{ component.componentName }}</span>

          <a class="columns medium-3" ng-hide="component.isOverridden"
             ng-click="dashboardCtrl.modifyComponentStatusForOverridden(component)" translate="gss.overrideStatus">
          </a>

          <a class="columns medium-3" ng-show="component.isOverridden"
             ng-click="component.isOverridden=false" translate="gss.useDerivedStatus">
          </a>

          <cs-select class="component-status-selector columns medium-4"
                     ng-model="component.statusObj"
                     options="dashboardCtrl.statuses"
                     is-disabled="component.isOverridden"
                     on-change-fn="dashboardCtrl.modifyComponentStatus(component)">
          </cs-select>
        </div>

        <ul ng-show="hide">
          <li class="row showgrid" ng-repeat="subComponent in component.components">
            <span class="sub-component-name columns medium-5">{{ subComponent.componentName }}</span>

            <cs-select class="component-status-selector columns medium-4 medium-offset-3"
                       ng-model="subComponent.statusObj"
                       options="dashboardCtrl.statuses"
                       on-change-fn="dashboardCtrl.modifySubComponentStatus(component, subComponent)">
            </cs-select>
          </li>
        </ul>
      </li>
    </ul>

    <div ng-if="!dashboardCtrl.components.length" class="no-component-notification">
      <h6 translate="gss.componentsPage.listing.noComponentHeading"></h6>
      <a translate="gss.componentsPage.listing.noComponentText" ng-click="goToComponentsPage()"></a>
    </div>
  </div>
</div>
