<div ui-view="header"></div>

<cs-sp-container class="hercules-fix-paragraphs hercules-settings-table"
                 ng-if="!expresswayServiceDetails.serviceNotInstalled()">

  <cs-sp-section>
    <div class="section-title-row section-name" translate="hercules.alarms.alarms"></div>
    <div class="feature-list" ng-if="expresswayServiceDetails.selectedService().alarm_count > 0">
      <ul>
        <li class="feature" ng-repeat="alarm in expresswayServiceDetails.alarms2hosts()" ng-class="{'list-item': !$first}">
          <a ui-sref="cluster-details-new.alarm-details({alarm: alarm})">
            <i class="icon icon-error hercules-alarm status-icon"/>
            <span class="feature-name"><b>{{alarm.alarm.title}}</b> raised on {{alarm.hosts.length}} host(s)</span>
            <i class="feature-arrow"></i>
          </a>
        </li>
      </ul>
    </div>
    <p ng-if="expresswayServiceDetails.selectedService().alarm_count == 0" translate="hercules.alarms.noAlarms"></p>
  </cs-sp-section>

  <cs-sp-section>
    <div class="section-title-row section-name" translate="hercules.softwareUpgrade.softwareUpgrade"></div>
    <table>
      <tbody>
      <tr>
        <td translate="hercules.softwareUpgrade.currentVersion"></td>
        <td><span>{{expresswayServiceDetails.selectedService().connectors[0].version}}</span></td>
      </tr>
      <tr ng-if="expresswayServiceDetails.selectedService().software_upgrade_available">
        <td translate="hercules.softwareUpgrade.newVersion">New Version</td>
        <td><span>{{expresswayServiceDetails.selectedService().not_approved_package.version}}</span></td>
      </tr>
      <tr ng-if="!expresswayServiceDetails.selectedService().software_upgrade_available">
        <td colspan="2" translate="hercules.softwareUpgrade.noNewAvailable"></td>
      </tr>
      </tbody>
    </table>
    <button class="button secondary"
            ng-click="expresswayServiceDetails.upgrade()"
            ng-if="expresswayServiceDetails.selectedService().software_upgrade_available"
            translate="hercules.softwareUpgrade.upgrade">
    </button>
  </cs-sp-section>

  <cs-sp-section>
    <div class="section-title-row section-name" translate="hercules.connectors.hosts"></div>
    <div class="feature-list">
      <ul>
        <li class="feature" ng-repeat="connector in expresswayServiceDetails.selectedService().connectors"
            ng-class="{'list-item': !$first}">
          <a
            ui-sref="cluster-details-new.host-details({host: connector.host, clusterId: expresswayServiceDetails.clusterId, serviceType: expresswayServiceDetails.serviceType})">
            <i class="fa fa-circle status-icon"
               ng-class="connector.alarms.length > 0 ? 'hercules-state-alarm' : 'hercules-state-'+connector.state"></i>
            <span class="feature-name">{{connector.host.host_name}}</span>
            <span class="feature-status" ng-if="connector.alarms.length == 0"
                  translate="{{'hercules.status.' + (connector.state || 'unknown') }}"></span>
            <span class="feature-status" ng-if="connector.alarms.length > 0"
                  translate="hercules.status.alarm"></span>
            <i class="feature-arrow"></i>
          </a>
        </li>
      </ul>
    </div>
  </cs-sp-section>

</cs-sp-container>

<cs-sp-container class="hercules-fix-paragraphs" ng-if="expresswayServiceDetails.serviceNotInstalled()">
  <p>
    The <span translate="hercules.serviceNames.{{expresswayServiceDetails.serviceId}}"></span> is not installed on this cluster.
  </p>
</cs-sp-container>
