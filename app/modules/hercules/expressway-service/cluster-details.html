<div ui-view="header"></div>
<cs-sp-container class="hercules-fix-paragraphs hercules-settings-table">
  <cs-sp-section>
    <div class="section-title-row section-name" translate="hercules.alarms.alarms"></div>
    <div class="feature-list" ng-if="expresswayClusterDetails.clusterAggregates.alarms.length > 0">
      <ul>
        <li class="feature" ng-repeat="alarm in expresswayClusterDetails.clusterAggregates.alarms" ng-class="{'list-item': !$first}">
          <a ui-sref="cluster-details.alarm-details({alarm: alarm})">
            <i class="icon icon-error red status-icon"></i>
            <span class="feature-name">{{alarm.description}}</span>
            <i class="feature-arrow"></i>
          </a>
        </li>
      </ul>
    </div>
    <p ng-if="expresswayClusterDetails.clusterAggregates.alarms.length === 0" translate="hercules.alarms.noAlarms"></p>
  </cs-sp-section>
  <cs-sp-section>
    <div class="section-title-row section-name" translate="hercules.softwareUpgrade.softwareUpgrade"></div>
    <table>
      <tbody>
      <tr ng-if="!expresswayClusterDetails.showUpgradeProgress">
        <td translate="hercules.softwareUpgrade.currentVersion"></td>
        <td><span>{{expresswayClusterDetails.softwareUpgrade.provisionedVersion}}</span></td>
      </tr>
      <tr ng-if="expresswayClusterDetails.showUpgradeProgress" class="software-upgrade-container">
        <td colspan="2" ng-if="expresswayClusterDetails.fakeUpgrade">
          <div class="progressbar-info">
            <span class="progressbar-label" translate="hercules.softwareUpgrade.pending"></span>
            <span class="progressbar-progress">0 / {{expresswayClusterDetails.softwareUpgrade.numberOfHosts}}</span>
          </div>
          <progressbar animate="true" value="10" max="100"></progressbar>
        </td>
        <td colspan="2" ng-if="!expresswayClusterDetails.fakeUpgrade">
          <div class="progressbar-info">
            <span ng-show="!expresswayClusterDetails.upgradeJustFinished" class="progressbar-label" translate="hercules.softwareUpgrade.upgradingHost" translate-values="{host: expresswayClusterDetails.upgradeDetails.upgradingHostname, version: expresswayClusterDetails.softwareUpgrade.provisionedVersion}"></span>
            <span ng-if="expresswayClusterDetails.upgradeJustFinished" class="progressbar-label" translate="hercules.softwareUpgrade.upgradeDone"></span>
            <span class="progressbar-progress">{{expresswayClusterDetails.upgradeDetails.numberOfUpsmthngHosts}} / {{expresswayClusterDetails.softwareUpgrade.numberOfHosts}}</span>
          </div>
          <progressbar ng-show="!expresswayClusterDetails.upgradeJustFinished" animate="true" value="expresswayClusterDetails.upgradeDetails.numberOfUpsmthngHosts" max="expresswayClusterDetails.softwareUpgrade.numberOfHosts"></progressbar>
          <progressbar ng-show="expresswayClusterDetails.upgradeJustFinished" type="success" value="1" max="1"></progressbar>
        </td>
      </tr>
      </tr>
      <tr ng-if="!expresswayClusterDetails.showUpgradeProgress && expresswayClusterDetails.softwareUpgrade.isUpgradeAvailable">
        <td translate="hercules.softwareUpgrade.newVersion"></td>
        <td><span>{{expresswayClusterDetails.softwareUpgrade.availableVersion}}</span></td>
      </tr>
      </tbody>
    </table>
    <button class="btn btn--primary"
            ng-click="expresswayClusterDetails.upgrade()"
            ng-if="!expresswayClusterDetails.showUpgradeProgress && expresswayClusterDetails.softwareUpgrade.isUpgradeAvailable"
            translate="hercules.softwareUpgrade.upgrade">
    </button>
  </cs-sp-section>
  <cs-sp-section>
    <div class="section-title-row section-name" translate="hercules.connectors.hosts"></div>
    <div class="feature-list">
      <ul>
        <li class="feature" ng-repeat="host in expresswayClusterDetails.clusterAggregates.hosts | orderBy:'host.hostname'"
            ng-class="{'list-item': !$first}">
          <a
            ui-sref="cluster-details.host-details({host: host.hostname, clusterId: expresswayClusterDetails.clusterId, serviceType: expresswayClusterDetails.serviceType})">
            <i class="fa fa-circle status-icon" ng-class="'hercules-state-' + host.runningStateSeverity"></i>
            <span class="feature-name">{{host.hostname}}</span>
            <span class="feature-status">
              <span translate="{{'hercules.status.' + host.runningState }}"></span>
              <span ng-if="host.upgradeState === 'upgrading'"> | <span translate="hercules.status.upgrading"></span></span>
            </span>
            <i class="feature-arrow"></i>
          </a>
        </li>
      </ul>
    </div>
  </cs-sp-section>
</cs-sp-container>
