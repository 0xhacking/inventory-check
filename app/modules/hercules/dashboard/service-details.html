<cs-sp-container>

  <cs-sp-section>
    <div class="section-name" style="padding: 15px 0;">
      {{service.display_name}}
    </div>

    <!-- connectors -->
    <div ng-repeat="connector in service.connectors" class="list">
      <div ng-class="connector.state">
        <i class="fa fa-circle" />
        <span>{{connector.host.host_name}}:</span>
        <span translate="{{'hercules.status.' + (connector.state || 'unknown') }}"></span>
      </div>
    </div>
    <div ng-hide="service.connectors.length" class="list">
      <div class="disabled">
        <i class="fa fa-circle" />
        <span>Not installed on any hosts.</span>
      </div>
    </div>
  </cs-sp-section>

  <!-- connectors -->
  <cs-sp-section ng-show="service.needs_attention && service.alarm_count">
    <div ng-repeat="connector in service.connectors">

      <!-- connector error -->
      <div style="padding: 15px 0 5px 0;" class="clearfix" ng-repeat="alarm in connector.deduced_alarms">
        <span style="color: #f05d3b">{{connector.host.host_name}}</span>
        <span>is pending software upgrade from {{connector.version}} to {{alarm.expected_version}}.</span>
      </div>

      <!-- connector alarms -->
      <div ng-show="{{connector.alarms.length}}">
        <div class="clearfix" style="padding: 15px 0 5px 0; font-weight: bold;">
          <span style="color: #f05d3b">{{connector.host.host_name}}</span>
          <span ng-show="connector.alarms.length == 1">has reported {{connector.alarms.length}} alarm:</span>
          <span ng-hide="connector.alarms.length == 1">has reported {{connector.alarms.length}} alarms:</span>
        </div>

        <div ng-repeat="alarm in connector.alarms" style="padding-bottom: 5px;" class="clearfix">
          <span style="color: #f05d3b; text-transform: capitalize;">{{alarm.severity}}:</span>
          <span>{{alarm.title}}.</span>
          <span>{{alarm.description}}</span>
        </div>

        <div style="padding-bottom: 5px">
          Manage the alarms in the <a href="https://{{connector.host.host_name}}/alarms" target="_blank">alarms page</a>.
        </div>
      </div>
    </div>
  </cs-sp-section>

  <!-- sw upgrade -->
  <cs-sp-section ng-show="service.software_upgrade_available">
    <div class="section-name" style="padding: 15px 0;">
      Software Upgrade
    </div>

    <div ng-show="service.installed">
      <!-- sw update for existing service -->
        <div style="padding-bottom: 5px" class="clearfix">
          <span>A software update is available.</span>
          <span ng-show="service.connectors[0].version">Current version: {{service.connectors[0].version}}.</span>
          <span ng-show="service.not_approved_package.version">New version: {{service.not_approved_package.version}}.</span>
        </div>
        <button class="btn btn-info btn-sm" ng-click="showUpgradeDialog(service.not_approved_package, cluster, service.connectors[0].version)">
          <span>
            Upgrade software
          </span>
        </button>
    </div>

    <div ng-show="!service.installed">
      <button class="btn btn-info btn-sm" ng-click="showUpgradeDialog(service.not_approved_package, cluster, service.connectors[0].version)">
        <span>
          Install software
        </span>
      </button>
    </div>

  </cs-sp-section>

</cs-sp-container>
