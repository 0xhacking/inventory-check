<!-- Call Trial Modal -->

<!-- header -->
<div class="modal-header">
  <button type="button" class="close" ng-click="$dismiss()">
    <span class="sr-only" translate="common.close"></span>
  </button>
  <h3 class="modal-title" translate="trialModal.call.title"></h3>
</div>

<!-- body -->
<div class="modal-body trials">
  <form id="callTrialForm" class="cs-form trial-modal" name="trialForm">

    <!-- tbd: unable to add devices error msg (device trial limit reached) -->
    <div class="cs-form__section" ng-if="callTrial.limitReached && !callTrial.canAddMoreDevices">
      <div class="section__info">
        <h4 class="section__title" translate="trialModal.call.deviceTrialCapacityHeader"></h4>
      </div>
      <div class="section__content">
        <div class="sub-section__description">
          <div ng-if="callTrial.limitsError">
            <p translate="trialModal.call.deviceTrialUnavailable"></p>
          </div>
          <!-- TODO: Add tooltip when toolkit allows localized strings to contain the directive markup -->
          <div ng-if="!callTrial.limitsError">
            <p translate="trialModal.call.deviceTrialLimitReached"
              translate-values="{number: callTrial.maxTrials}">
            </p>
            <!-- todo: rm 'br' and layout with CSS after UX provides updated layout for this error msg -->
            <br />
            <p translate="trialModal.call.deviceTrialLimitHelp"></p>
          </div>
        </div>
      </div>
    </div>

    <!-- select devices -->
    <div class="cs-form__section" ng-if="callTrial.canAddMoreDevices || !callTrial.limitReached">
      <div class="section__info">
        <h4 translate="trialModal.call.selectDevicesHeader"></h4>
        <p class="section__description" translate="trialModal.call.deviceLimitDescription"></p>
      </div>
      <div class="section__content">
        <div class="sub-section">
          <h5 class="sub-section__label" translate="trialModal.call.meetingRoomCamera"></h5>
          <formly-form model="callTrial.details.roomSystems" fields="callTrial.roomSystemFields"></formly-form>
        </div>
        <div class="sub-section">
          <h5 class="sub-section__label" translate="trialModal.call.deskPhones"></h5>
          <formly-form model="callTrial.details.phones" fields="callTrial.deskPhoneFields"></formly-form>
        </div>
      </div>
    </div>

    <!-- shipping information -->
    <div class="cs-form__section">
      <div class="section__info">
        <h4 translate="trialModal.call.shippingInfo"></h4>
      </div>
      <div class="section__content">
        <formly-form model="callTrial.details.shippingInfo" fields="callTrial.shippingFields"></formly-form>
      </div>
    </div>
  </form>
</div>

<!-- footer -->
<div class="modal-footer">
  <a class="pad-top pull-left" ng-if="callTrial.canAddDevice || !callTrial.limitReached"
    ng-click="callTrial.skip(true); trial.nextStep()"
    translate="trialModal.call.skipAddDevices">
  </a>
  <button class="btn" ng-click="trial.previousStep()" ng-disabled="trial.loading"
    translate="common.back">
  </button>
  <button id="startTrialButton" class="btn btn--primary" type="button" cs-btn loading="trial.loading"
    ng-click="trialForm.$setPristine(true); callTrial.skip(false); trial.nextStep()" ng-disabled="trialForm.$invalid">
      <span ng-if="!trial.hasNextStep()" translate="partnerHomePage.startTrial"></span>
      <span ng-if="trial.hasNextStep()" translate="common.next"></span>
    </span>
  </button>
</div>
