<div class="flex-container">
  <div class="flex-item-no-resize upload-progress">
    <div class="csv-process-content">
      <div class="progressbar">
        <div class="progressbar-info">
          <span class="progressbar-label"
                ng-if="!csv.model.isRetrying && csv.model.processProgress < 100 && !csv.isCancelledByUser"
                translate="firstTimeWizard.processing"></span>
          <span class="progressbar-label" ng-if="csv.isCancelledByUser"
                translate="firstTimeWizard.canceling"></span>
          <span class="progressbar-label retry-label" ng-show="csv.model.isRetrying">
            <span translate="userManage.bulk.retryingUsers" translate-value-users="{{csv.model.usersToRetry.length}}"
                  translate-interpolation="messageformat"></span>
            <span translate="userManage.bulk.retryingIn"></span>
            <span ng-show="csv.model.retryTimerParts.hours > 0" translate="time.hours"
                  translate-value-time="{{csv.model.retryTimerParts.hours}}"
                  translate-interpolation="messageformat"></span>
            <span ng-show="csv.model.retryTimerParts.minutes > 0" translate="time.minutes"
                  translate-value-time="{{csv.model.retryTimerParts.minutes}}"
                  translate-interpolation="messageformat"></span>
            <span translate="time.seconds" translate-value-time="{{csv.model.retryTimerParts.seconds}}"
                  translate-interpolation="messageformat"></span>
          </span>
          <span class="progressbar-label" ng-if="csv.model.processProgress == 100" translate="common.done"></span>
          <span class="progressbar-progress">{{csv.model.numTotalUsers}}/{{csv.model.numMaxUsers}}</span>
        </div>
        <progressbar animate="false" class="progress-striped active" value="csv.model.processProgress"
                     type="primary"></progressbar>
        <div class="csv-filename">{{csv.model.fileName}}</div>
      </div>
      <div ng-if="csv.model.isProcessing" class="close-button">
        <button type="button" class="close" ng-click="vm.onCancelImport()">
          <span class="sr-only" translate="common.close"></span>
        </button>
      </div>
    </div>
  </div>

  <!-- display the results stats -->
  <div class="flex-item-no-resize upload-stats">
    <div class="stat new-users" ng-class="{disabled: csv.model.numNewUsers === 0}" ng-if="!csv.isDirSyncEnabled">
      <div class="total">{{csv.model.numNewUsers}}</div>
      <h4 class="total-title" translate="userManage.bulk.newUsers"></h4>
    </div>
    <div class="stat existing-users" ng-class="{disabled: csv.model.numExistingUsers === 0}">
      <div class="total">{{csv.model.numExistingUsers}}</div>
      <h4 class="total-title" translate="userManage.bulk.existingUsers"></h4>
    </div>
    <div class="stat retry-users" ng-if="csv.model.usersToRetry.length > 0">
      <div class="total">{{csv.model.usersToRetry.length}}</div>
      <h4 class="total-title" translate="userManage.bulk.retryUsers"></h4>
    </div>
    <div class="stat error-users" ng-class="{disabled: csv.model.userErrorArray.length === 0}">
      <div class="total">{{csv.model.userErrorArray.length}}</div>
      <h4 class="total-title" translate="userManage.bulk.errorUsers"></h4>
    </div>
  </div>

  <!-- display the timer for how long the upload is taking -->
  <div class="flex-item-no-resize upload-timer">
    <div>
      <span translate="firstTimeWizard.timeElapsed"></span>
      <timer interval="1000">
      <span ng-show="hours" translate="time.hours" translate-value-time="{{hours}}"
            translate-interpolation="messageformat"></span>
        <span ng-show="minutes" translate="time.minutes" translate-value-time="{{minutes}}"
              translate-interpolation="messageformat"></span>
        <span translate="time.seconds" translate-value-time="{{seconds}}"
              translate-interpolation="messageformat"></span>
      </timer>
    </div>
  </div>

  <!-- display the error details -->
  <div class="flex-item-resize">
    <div class="flex-container upload-errors" ng-if="csv.model.userErrorArray.length > 0">

      <div class="flex-item-no-resize">
        <h4 translate="userManage.bulk.errorUsers"></h4>
        <div ng-disabled="csv.model.isProcessing">
          <csv-download type="error" filename="errors.csv" no-icon
                        anchor-text="{{::'userManage.bulk.import.exportErrors'|translate}}"></csv-download>
        </div>
        <p translate="userManage.bulk.import.errorResolveInstructions"></p>
      </div>

      <div class="flex-item-no-resize table-header">
        <div class="row">
          <span class="columns small-1 center error-row" translate="userManage.bulk.import.headerRow"></span>
          <span class="columns small-11 error-desc" translate="userManage.bulk.import.headerErrorMessage"></span>
        </div>
      </div>

      <div class="flex-item-resize table-body">
        <div class="scroller">
          <div ng-repeat="data in csv.model.userErrorArray" class="row">
            <span class="columns small-1 center error-row">{{::data.row}}</span>
            <span class="columns small-11 error-desc">{{::data.error}}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>
