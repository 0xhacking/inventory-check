<div class="aa-schedule-modal">
  <div class="modal-header">
    <button type="button" class="close" ng-click="$dismiss()">
      <span class="sr-only">Close</span>
    </button>
    <p class="modal-title"
    translate="autoAttendant.schedule"></p>
  </div>
  <div class="modal-body">
    <p class="aa-schedule-subtitle">{{'autoAttendant.scheduleOpenClosed' | translate}}<a ng-click="aaScheduleModalCtrl.toggleSection('hours')" class="icon icon-right-arrow pull-right"></a></p>
      <div collapse="aaScheduleModalCtrl.toggleHours">
      <form name="aaScheduleModalCtrl.hoursForm" role="form" novalidate>
       <div ng-repeat="hours in aaScheduleModalCtrl.openhours">
   
        <div class="row">
          <div class="cs-input-group columns small-6" ng-class="{'error': hoursForm.starttime.$invalid && hoursForm.starttime.$touched}">
            <label for="starttime" translate="autoAttendant.scheduleOpenTime"></label>
            <input
            id="starttime"
            name="starttime"
            type="time"
            ng-model="hours.starttime"
            required>
          </div>
          <div class="cs-input-group columns small-6" ng-class="{'error':  aaScheduleModalCtrl.isOpenHoursAfterCloseHours(hours)}">
            <label for="endtime" translate="autoAttendant.scheduleClosedTime"></label>
            <input
            id="endtime"
            name="endtime"
            type="time"
            ng-model="hours.endtime"
            required>
            <div ng-show="aaScheduleModalCtrl.isOpenHoursAfterCloseHours(hours)">
              <label translate="autoAttendant.scheduleClosedTimeCheck"></label>
            </div>
          </div>
          <div class="columns">
            <span class="aa-schedule-days" ng-repeat="day in hours.days">
              <cs-checkbox ckid="{{'chk_'+$parent.$index+'_'+$index}}" ng-model="day.active" label="{{day.label}}"></cs-checkbox>
            </span>
          </div>
          <div class="columns">
            <a class="icon icon-trash aa-schedule-trash" ng-click="aaScheduleModalCtrl.deleteRange($index);"><span class="sr-only ng-scope" translate="huronHuntGroup.deleteAction">Delete</span></a>
          </div>
        </div>
      
    </div>
    </form>
    <div ng-show="aaScheduleModalCtrl.openhours.length === 0">
      <p translate="autoAttendant.scheduleMissing"></p>
    </div>
    <a id="addHours" ng-click="aaScheduleModalCtrl.addRange();" translate="autoAttendant.scheduleAddHours"></a>
    </div>
  </div>
  <div class="simple-accordion aa-holidays">
    <p class="aa-schedule-subtitle">{{'autoAttendant.scheduleHolidays' | translate}} <a ng-click="aaScheduleModalCtrl.toggleSection('holidays')" class="icon icon-right-arrow pull-right"></a></p>
    <div collapse="aaScheduleModalCtrl.toggleHolidays">
      <form name="aaScheduleModalCtrl.holidaysForm" role="form" novalidate>
        <div class="row">
          <input
            cs-input
            type="checkbox"
            ng-model="aaScheduleModalCtrl.holidayBehavior"
            id="holidayBehavior"
            name="holidayBehavior"
            cs-input-label="Holidays Follow Closed Behavior"
            cs-input-group-size="left-margin-20">
        </div>
        <cs-accordion close-others="aaScheduleModalCtrl.oneAtATime" class="simple-accordion" ng-if="aaScheduleModalCtrl.holidays.length > 0">
          <cs-accordion-group ng-repeat="holiday in aaScheduleModalCtrl.holidays" is-disabled="aaScheduleModalCtrl.isDisabled()" is-open="holiday.isOpen">
            <cs-accordion-heading>
              <div class="row" ng-click="aaScheduleModalCtrl.openSection()">
                <div ng-bind="holiday.name"></div>
                <div>
                  {{holiday.date | date:'mediumDate'}}
                  <i class="icon icon-trash pull-right" ng-click="aaScheduleModalCtrl.removeHoliday($index)"></i>
                </div>
              </div>
            </cs-accordion-heading>
            <i class="icon icon-trash pull-right" ng-click="aaScheduleModalCtrl.removeHoliday($index)"></i>
            <ng-form name="holidayForm">
              <div class="row">
                <div class="columns medium-6">
                  <input
                    cs-input
                    ng-required="true"
                    type="text"
                    id="holidayName"
                    name="holidayName"
                    placeholder="Name"
                    ng-model="holiday.name"
                    cs-input-label="{{'callPark.name' | translate }}"
                    cs-input-group-size="medium-12"
                    cs-input-messages="aaScheduleModalCtrl.messages">
                  <label class="cs-input__label" for="html-input" translate="autoAttendant.selectDate"></label>
                  <div ng-class="{'error': holidayForm.holidayDate.$error.required && holidayForm.holidayDate.$dirty}">
                    <cs-datepicker name="holidayDate" ng-model="holiday.date" placeholder="Choose a day" required></cs-datepicker>
                    <div class="cs-input__messages" ng-messages="holidayForm.holidayDate.$error" role="alert">
                      <div class="message" ng-message="{{::key}}" ng-repeat="(key, value) in ::aaScheduleModalCtrl.messages">{{::value}}</div>
                    </div>
                  </div>
                </div>
                <div class="columns medium-6 aa-hour-right">
                  <div class="cs-checkbox-group">
                    <input
                      cs-input
                      type="checkbox"
                      ng-model="holiday.allDay"
                      id="checkbox{{$index}}"
                      name="checkbox{{$index}}"
                      cs-input-label="{{'autoAttendant.allDay' | translate}}"
                      ng-change="aaScheduleModalCtrl.changeAllDay(holidayForm, holiday)">
                  </div>
                  <div class="row">
                    <div class="columns medium-6" ng-class="{'error': holidayForm.holidayStart.$error.required && holidayForm.holidayStart.$dirty && !holiday.allDay}">
                      <label class="cs-input__label" for="holidayStart" translate="cdrLogs.startTime"></label>
                      <input name="holidayStart" ng-model="holiday.starttime" ng-disabled="holiday.allDay" ng-required="!holiday.allDay" class="cs-input" type="time">
                      <div class="cs-input__messages" ng-messages="holidayForm.holidayStart.$error" role="alert">
                        <div class="message" ng-message="{{::key}}" ng-repeat="(key, value) in ::aaScheduleModalCtrl.messages">{{::value}}</div>
                      </div>
                    </div>
                    <div class="columns medium-6" ng-class="{'error': holidayForm.holidayEnd.$error.compareTo && holidayForm.holidayEnd.$dirty && !holiday.allDay}">
                      <label class="cs-input__label" for="holidayEnd" translate="cdrLogs.endTime"></label>
                      <input name="holidayEnd" ng-model="holiday.endtime" compare-time="holiday.starttime" reset-compare="holiday.allDay" start-time="holiday.holidayStart" ng-disabled="holiday.allDay" ng-required="!holiday.allDay" class="cs-input" type="time">
                      <div class="cs-input__messages" ng-messages="holidayForm.holidayEnd.$error" role="alert">
                        <div class="message" ng-message="{{::key}}" ng-repeat="(key, value) in ::aaScheduleModalCtrl.messages">{{::value}}</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </ng-form>
          </cs-accordion-group>
        </cs-accordion>
        <a id="addHoliday" ng-click="aaScheduleModalCtrl.addHoliday();"><i class="icon icon-plus-circle"></i>{{'autoAttendant.scheduleAddAdditionalHolidays' | translate}}</a>
      </form>
    </div>
  </div>
  <div class="modal-footer">
    <button id="cancelDeleteFeature" class="btn" ng-click="$dismiss();" translate="common.cancel"></button>
    <button id="saveOpenClosedBtn" cs-btn class="btn btn-primary" ng-disabled="!aaScheduleModalCtrl.isSavable() || (aaScheduleModalCtrl.hoursForm.$pristine && aaScheduleModalCtrl.holidaysForm.$pristine)" ng-click="aaScheduleModalCtrl.save()">
      <span translate="common.save"></span></button>
    </div>
    
  </div>

