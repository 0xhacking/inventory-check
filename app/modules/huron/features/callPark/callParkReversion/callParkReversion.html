<script type="text/ng-template" id="callParkReversionTemplate.html">
  <a class="member__name">
    <span ng-bind-html="match.label.firstName | typeaheadHighlight:query" ng-if="match.label.firstName"></span>
    <span ng-bind-html="match.label.lastName | typeaheadHighlight:query" ng-if="match.label.lastName"></span>
    <span ng-bind-html="match.label.number | typeaheadHighlight:query" ng-if="match.label.number"></span>
    <span ng-show="match.label.lastName">(<span ng-bind-html="match.label.userName | typeaheadHighlight:query"></span>)</span>
    <span ng-show="!match.label.lastName && !match.label.displayName && !match.label.number" ng-bind-html="match.label.userName | typeaheadHighlight:query"></span>
    <span ng-show="!match.label.userName && !match.label.number" ng-bind-html="match.label.displayName | typeaheadHighlight:query"></span>
  </a>
  <div class="member__line">
    <span ng-bind-html="(match.label.numbers | callParkMemberNumbersFilter : true) | typeaheadHighlight:query" ng-if="match.label.numbers"></span>
  </div>
</script>
<div ng-form="$ctrl.cpReversionForm">
  <div class="row form-group">
    <input
      cs-input
      type="radio"
      id="radioParker"
      ng-value="'parker'"
      ng-model="$ctrl.reversionType"
      ng-click="$ctrl.onSelectRevertToParker()"
      cs-input-label="{{:: 'callPark.reversionParkerLabel' | translate}}">
  </div>
  <div class="row form-group">
    <input
      cs-input
      type="radio"
      class="cs-input"
      id="radioParkDestination"
      ng-value="'destination'"
      ng-model="$ctrl.reversionType"
      ng-click="$ctrl.onSelectAnotherDestination()"
      cs-input-label="{{:: 'callPark.reversionOtherLabel' | translate}}">
  </div>
  <div class="row form-group">
    <div ng-if="$ctrl.showReversionLookup" class="typeahead">
      <cs-call-destination
        ng-disabled="$ctrl.reversionType === 'parker'"
        model="$ctrl.selectedReversionNumber"
        inputs="$ctrl.callDestInputs"
        select-type="select"
        external-number-region-code-fn="$ctrl.getExternalRegionCode()"
        ng-keyup="$ctrl.validateReversionNumber()"
        internal-number-data-fn="$ctrl.getMemberList(data)"
        internal-number-on-select="$ctrl.onSelectReversionMember(data)"
        internal-number-template-url="callParkReversionTemplate.html"
        on-change-fn="$ctrl.setSelectedReversionNumber(model)">
      </cs-call-destination>
    </div>
    <div ng-if="$ctrl.showMember">
      <cs-card-layout>
        <cs-card
          class="small header-background primary call-park-member-card">
          <article>
            <a href ng-click="$ctrl.toggleMemberPanel()">
              <header ng-class="{'open-panel' : $ctrl.openPanel}">
                <div class="header-with-right-icon">
                  <h5 class="ellipsis" ng-if="$ctrl.fallbackDestination.name">{{$ctrl.fallbackDestination.name}}</h5>
                  <h5 class="ellipsis" ng-if="!$ctrl.fallbackDestination.name && $ctrl.fallbackDestination.number">{{$ctrl.fallbackDestination.number}}</h5>
                  <i class="icon icon-arrow-next icon-lg"></i>
                </div>
              </header>
            </a>
            <section ng-if="($ctrl.openPanel)">
              <fieldset>
                <p class="primary-number">{{$ctrl.directoryNumber | callParkReversionDirectoryNumberFilter}}</p>
                <p>
                  <a href ng-click="$ctrl.removeMember()" translate="common.remove"></a>
                </p>
              </fieldset>
            </section>
          </article>
        </cs-card>
      </cs-card-layout>
      <div class="ui-mt">
        <input
          cs-input
          type="checkbox"
          id="ckSendToVoicemail"
          name="ckSendToVoicemail"
          ng-model="$ctrl.fallbackDestination.sendToVoicemail"
          cs-input-label="{{:: 'callPark.voicemailCheckLabel' | translate}}"
          ng-click="$ctrl.onChangeSendToVoicemail()">
      </div>
    </div>
  </div>
</div>
