<div class="notification"></div>
<div class="panel panel-default">
    <div class="panel-heading panel-heading-default">
      <div id="listLogs">
        <h3 class="panel-title panel-title-default">
          <strong id="subtitleLogs" translate="supportPage.subtitleLogs"></strong>
        </h3>
      </div>
    </div>

    <div class="panel-body">
      <form role="form">
        <div class="form-group">
          <br/>
          <input class="form-control typeahead" type="text" id="logsearchfield" placeholder=''/> 
          <br>
       </div>

       <div class="form-group">
        <button id="logSearchBtn" class="btn btn-primary pull-right" ng-click="getLogs()" data-loading-text="<i class='fa fa-refresh fa-spin'></i>"><span translate="supportPage.listlogsbtn"></span></button>
      </div>
    </form>
  </div>
</div>

<div class="panel panel-default"  id="logs-panel" ng-hide="callInfoActive">
    <div id="userSupport">
      <div class="panel-heading panel-heading-default">
        <h3 class="panel-title panel-title-default">
          <strong id="listSupportItems">{{'supportPage.userLogs' | translate }}</strong>
        </h3>
      </div>

      <div class="panel-body">
        <label ng-show="userLogs.length === 0 || !userLogs"><span id="noResults" translate="supportPage.noResults"></label>
        <table class="table" ng-show="userLogs">
          <thead>
            <tr>
              <th nowrap ng-click="toggleSort('emailAddress', 'sortIconEmailAddress')"><span id="emailAddressHeading" translate="supportPage.logEmailAddress"></span> <i class="fa {{sortIconEmailAddress}}"></i></th>
              <th nowrap ng-click="toggleSort('locusId', 'sortIconLocusId')"><span id="locusIdHeading" translate="supportPage.logLocusId"></span> <i class="fa {{sortIconLocusId}}"></i></th>
              <th nowrap ng-click="toggleSort('callStart', 'sortIconCallStart')"><span id="callStartHeading" translate="supportPage.logCallStart"></span> <i class="fa {{sortIconCallStart}}"></i></th>
              <th nowrap ng-click="toggleSort('date', 'sortIconDate')"><span id="dateHeading" translate="supportPage.logDate"></span> <i class="fa {{sortIconDate}}"></i></th>
              <th nowrap><span translate="supportPage.logAction"></span></th>
              <th nowrap><span translate="supportPage.callAction"></span></th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="log in userLogs | orderBy:logsSortBy:reverseLogs">
              <td>{{log.emailAddress}}</td>
              <td>{{log.locusId}}</td>
              <td>{{log.callStart}}</td>
              <td>{{formatDate(log.date)}}</td>
              <td class="center"><a ng-click="downloadLog(log.fullFilename)"><span id="download-icon"><i class="fa fa-download"></i></a></td>
              <td class="center"><a ng-click="showCallInfo(log.emailAddress, log.locusId, log.callStart)"><span id="callInfo-icon"><i class="fa fa-info"></i></a></td>
            </tr>
          </tbody>
        </table>
      </div>  
    </div>
  </div>
  <div class="panel panel-default call-info-panel" ng-show="callInfoActive">
    <div class="panel-heading panel-heading-default">
      <div>
        <h3 class="panel-title panel-title-default">
          <strong id="subTitleCallInfo" translate="supportPage.subTitleCallInfo"></strong>
          <strong>{{emailAddress}}</strong> 
        </h3>
      </div>
      <div  ng-click="closeCallInfo()">
        <span style="float: right"><i id='closeAddUser' class="fa fa-times add-user-close"></i></span>
      </div>
    </div>
    <div class="panel-body">
      <label ng-show="logInfo.length === 0 || !logInfo"><span id="noResults" translate="supportPage.noResults"></label>
      <table class="table" ng-show="logInfo.length !== 0">
        <thead>
          <tr>
            <th>locusId : {{logInfo[0].locusId}}</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="info in logInfo">
            <td>
              <table class="table">
                <thead>
                  <tr>
                    <td>Locus Call Start Time</td>
                    <td>Attributes</td>
                    <td>Value</td>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>{{info.locusCallStartTime}}</td>
                    <td>userId</td>
                    <td>{{info.userId}}</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td>orgId</td>
                    <td>{{info.orgId}}</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td>locusId</td>
                    <td>{{info.locusId}}</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td>locusCallStartTime</td>
                    <td>{{info.locusCallStartTime}}</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td>deviceId</td>
                    <td>{{info.deviceId}}</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td>isGroupCall</td>
                    <td>{{info.isGroupCall}}</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td>callDuration</td>
                    <td>{{info.callDuration}}</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td>userAgent</td>
                    <td>{{info.usrAgent}}</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td>networkName</td>
                    <td>{{info.networkName}}</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td>networkType</td>
                    <td>{{info.networkType}}</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td>trackingId</td>
                    <td>{{info.trackingId}}</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td>audioStart</td>
                    <td>{{info.audioStart}}</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td>videoStart</td>
                    <td>{{info.videoStart}}</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td>audioRxJitter</td>
                    <td>{{info.audioRxJitter}}</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td>audioTxJitter</td>
                    <td>{{info.audioTxJitter}}</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td>videoRxJitter</td>
                    <td>{{info.videoRxJitter}}</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td>videoTxJitter</td>
                    <td>{{info.videoTxJitter}}</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td>audioRxLossRatio</td>
                    <td>{{info.audioRxLossRatio}}</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td>audioTxLossRatio</td>
                    <td>{{info.audioTxLossRatio}}</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td>videoRxLossRatio</td>
                    <td>{{info.videoRxLossRatio}}</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td>videoTxLossRatio</td>
                    <td>{{info.videoTxLossRatio}}</td>
                  </tr>
                  <tr ng-show="info.errorCode === 0">
                    <td></td>
                    <td>errorCode</td>
                    <td>0</td>
                  </tr>
                  <tr ng-show="info.errorCode === 1">
                    <td></td>
                    <td>error.component</td>
                    <td>{{info.component}}</td>
                  </tr>
                  <tr ng-show="info.errorCode === 1">
                    <td></td>
                    <td>error.message</td>
                    <td>{{info.errMessage}}</td>
                  </tr>
                </tbody>
              </table>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
