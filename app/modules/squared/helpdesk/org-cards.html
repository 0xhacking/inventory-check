<cs-card-layout block-view="true" class="helpdesk-cards">
  <cs-card class="large header-bar primary" ng-if="helpdeskOrgCtrl.messageCard.entitled">
    <article>
      <header class="align-center">
        <div class="overview-header">
          <i class="icon icon-circle-message"></i>{{'helpdesk.message' | translate}}
        </div>
      </header>
      <section>
        <h5 translate="helpdesk.licenses"></h5>
        <span ng-if="helpdeskOrgCtrl.messageCard.aggregatedLicenses.length === 0" translate="helpdesk.none"></span>

        <div ng-repeat="aggregatedLicense in helpdeskOrgCtrl.messageCard.aggregatedLicenses">
          <span>{{aggregatedLicense.displayName}}: </span>
          <span ng-if="!helpdeskOrgCtrl.licenseUsageReady">{{aggregatedLicense.totalVolume}} licenses</span>
          <span
            ng-if="helpdeskOrgCtrl.licenseUsageReady">{{aggregatedLicense.totalUsage || 0}} of {{aggregatedLicense.totalVolume}} in use ({{aggregatedLicense.usagePercentage}}%)</span>
          <span ng-if="aggregatedLicense.isTrial">| </span>
          <span class="label warning" ng-if="aggregatedLicense.isTrial" translate="helpdesk.trial"></span>
          <span ng-if="aggregatedLicense.isTrial && aggregatedLicense.trialExpiresInDays > 0">{{helpdeskOrgCtrl.daysLeftText(aggregatedLicense)}}</span>
            <span ng-if="aggregatedLicense.isTrial && aggregatedLicense.trialExpiresInDays == 0"
                  class="red">{{'helpdesk.licenseStatus.expired' |  translate}}</span>
          <span ng-if="aggregatedLicense.licenses.length > 1">|
            <a href
               ng-click="helpdeskOrgCtrl.showLicenseToggles[aggregatedLicense.key] = !helpdeskOrgCtrl.showLicenseToggles[aggregatedLicense.key]"
               translate="helpdesk.more"></a>
          </span>

          <div ng-repeat="license in aggregatedLicense.licenses" style="margin-left: 1rem;"
               collapse="!helpdeskOrgCtrl.showLicenseToggles[aggregatedLicense.key]">
            <span>{{'helpdesk.licenseStatus.' + (license.status | lowercase) | translate}}:</span>
            <span
              ng-if="helpdeskOrgCtrl.licenseUsageReady">{{license.usage || 0}} of {{license.volume}} in use</span>
            <span ng-if="!helpdeskOrgCtrl.licenseUsageReady">{{license.volume}} licenses</span>
            <span ng-if="license.isTrial">| </span>
            <span class="label warning" ng-if="license.isTrial" translate="helpdesk.trial"></span>
            <span
              ng-if="license.isTrial && license.trialExpiresInDays > 0">{{helpdeskOrgCtrl.daysLeftText(license)}}</span>
            <span ng-if="license.isTrial && license.trialExpiresInDays == 0"
                  class="red">{{'helpdesk.licenseStatus.expired' |  translate}}</span>
          </div>
        </div>
      </section>
      <footer class="org-card-footer">
        <span class="status right">
          <a ng-href="{{helpdeskOrgCtrl.statusPageUrl}}" target="_blank">
            <i class="icon icon-circle circle-status-icon" ng-class="helpdeskOrgCtrl.healthStatuses.message"></i>
          </a>
        </span>
      </footer>
    </article>
  </cs-card>

  <cs-card class="large header-bar meetings" ng-show="helpdeskOrgCtrl.meetingCard.entitled">
    <article>
      <header class="align-center">
        <div class="overview-header">
          <i class="icon icon-circle-group"></i>{{'helpdesk.meeting' | translate}}
        </div>
      </header>
      <section>
        <h5 translate="helpdesk.licenses"></h5>
        <span ng-if="helpdeskOrgCtrl.meetingCard.aggregatedLicenses.length === 0" translate="helpdesk.none"></span>

        <div ng-repeat="aggregatedLicense in helpdeskOrgCtrl.meetingCard.aggregatedLicenses">
          <span ng-if="!aggregatedLicense.siteUrl">{{aggregatedLicense.displayName}}: </span>
          <span
            ng-if="aggregatedLicense.siteUrl">{{aggregatedLicense.displayName}} ({{aggregatedLicense.siteUrl}}): </span>
          <span ng-if="!helpdeskOrgCtrl.licenseUsageReady">{{aggregatedLicense.totalVolume}} licenses</span>
          <span
            ng-if="helpdeskOrgCtrl.licenseUsageReady">{{aggregatedLicense.totalUsage || 0}} of {{aggregatedLicense.totalVolume}} in use ({{aggregatedLicense.usagePercentage}}%)</span>
          <span ng-if="aggregatedLicense.isTrial">| </span>
          <span class="label warning" ng-if="aggregatedLicense.isTrial" translate="helpdesk.trial"></span>
          <span ng-if="aggregatedLicense.isTrial && aggregatedLicense.trialExpiresInDays > 0">{{helpdeskOrgCtrl.daysLeftText(aggregatedLicense)}}</span>
            <span ng-if="aggregatedLicense.isTrial && aggregatedLicense.trialExpiresInDays == 0"
                  class="red">{{'helpdesk.licenseStatus.expired' |  translate}}</span>
          <span ng-if="aggregatedLicense.licenses.length > 1">|
            <a href
               ng-click="helpdeskOrgCtrl.showLicenseToggles[aggregatedLicense.key] = !helpdeskOrgCtrl.showLicenseToggles[aggregatedLicense.key]"
               translate="helpdesk.more"></a>
          </span>

          <div ng-repeat="license in aggregatedLicense.licenses" style="margin-left: 1rem;"
               collapse="!helpdeskOrgCtrl.showLicenseToggles[aggregatedLicense.key]">
            <span>{{'helpdesk.licenseStatus.' + (license.status | lowercase) | translate}}:</span>
            <span
              ng-if="helpdeskOrgCtrl.licenseUsageReady">{{license.usage || 0}} of {{license.volume}} in use</span>
            <span ng-if="!helpdeskOrgCtrl.licenseUsageReady">{{license.volume}} licenses</span>
            <span ng-if="license.isTrial">| </span>
            <span class="label warning" ng-if="license.isTrial" translate="helpdesk.trial"></span>
            <span
              ng-if="license.isTrial && license.trialExpiresInDays > 0">{{helpdeskOrgCtrl.daysLeftText(license)}}</span>
            <span ng-if="license.isTrial && license.trialExpiresInDays == 0"
                  class="red">{{'helpdesk.licenseStatus.expired' |  translate}}</span>
          </div>
        </div>
      </section>
      <footer class="org-card-footer">
        <span class="status right">
          <a ng-href="{{helpdeskOrgCtrl.statusPageUrl}}" target="_blank">
            <i class="icon icon-circle circle-status-icon" ng-class="helpdeskOrgCtrl.healthStatuses.meeting"></i>
          </a>
        </span>
      </footer>
    </article>
  </cs-card>

  <cs-card class="large header-bar people" ng-show="helpdeskOrgCtrl.callCard.entitled">
    <article>
      <header class="align-center">
        <div class="overview-header">
          <i class="icon icon-circle-call"></i>{{'helpdesk.call' | translate}}
        </div>
      </header>
      <section>
        <h5 translate="helpdesk.licenses"></h5>
        <span ng-if="helpdeskOrgCtrl.callCard.aggregatedLicenses.length === 0" translate="helpdesk.none"></span>

        <div ng-repeat="aggregatedLicense in helpdeskOrgCtrl.callCard.aggregatedLicenses">
          <span>{{aggregatedLicense.displayName}}: </span>
          <span ng-if="!helpdeskOrgCtrl.licenseUsageReady">{{aggregatedLicense.totalVolume}} licenses</span>
          <span
            ng-if="helpdeskOrgCtrl.licenseUsageReady">{{aggregatedLicense.totalUsage || 0}} of {{aggregatedLicense.totalVolume}} in use ({{aggregatedLicense.usagePercentage}}%)</span>
          <span ng-if="aggregatedLicense.isTrial">| </span>
          <span class="label warning" ng-if="aggregatedLicense.isTrial" translate="helpdesk.trial"></span>
          <span ng-if="aggregatedLicense.isTrial && aggregatedLicense.trialExpiresInDays > 0">{{helpdeskOrgCtrl.daysLeftText(aggregatedLicense)}}</span>
            <span ng-if="aggregatedLicense.isTrial && aggregatedLicense.trialExpiresInDays == 0"
                  class="red">{{'helpdesk.licenseStatus.expired' |  translate}}</span>
          <span ng-if="aggregatedLicense.licenses.length > 1">|
            <a href
               ng-click="helpdeskOrgCtrl.showLicenseToggles[aggregatedLicense.key] = !helpdeskOrgCtrl.showLicenseToggles[aggregatedLicense.key]"
               translate="helpdesk.more"></a>
          </span>

          <div ng-repeat="license in aggregatedLicense.licenses" style="margin-left: 1rem;"
               collapse="!helpdeskOrgCtrl.showLicenseToggles[aggregatedLicense.key]">
            <span>{{'helpdesk.licenseStatus.' + (license.status | lowercase) | translate}}:</span>
            <span
              ng-if="helpdeskOrgCtrl.licenseUsageReady">{{license.usage || 0}} of {{license.volume}} in use</span>
            <span ng-if="!helpdeskOrgCtrl.licenseUsageReady">{{license.volume}} licenses</span>
            <span ng-if="license.isTrial">| </span>
            <span class="label warning" ng-if="license.isTrial" translate="helpdesk.trial"></span>
            <span
              ng-if="license.isTrial && license.trialExpiresInDays > 0">{{helpdeskOrgCtrl.daysLeftText(license)}}</span>
            <span ng-if="license.isTrial && license.trialExpiresInDays == 0"
                  class="red">{{'helpdesk.licenseStatus.expired' |  translate}}</span>
          </div>
        </div>
      </section>
      <footer class="org-card-footer">
        <span class="status right">
          <a ng-href="{{helpdeskOrgCtrl.statusPageUrl}}" target="_blank">
            <i class="icon icon-circle circle-status-icon" ng-class="helpdeskOrgCtrl.healthStatuses.call"></i>
          </a>
        </span>
      </footer>
    </article>
  </cs-card>

  <cs-card class="large header-bar gray" ng-show="helpdeskOrgCtrl.roomSystemsCard.entitled">
    <article>
      <header class="align-center">
        <div class="overview-header">
          <i class="icon icon-circle-telepresence"></i>{{'helpdesk.rooms' | translate}}
        </div>
      </header>
      <section>
        <h5 translate="helpdesk.licenses"></h5>
        <span ng-if="helpdeskOrgCtrl.roomSystemsCard.aggregatedLicenses.length === 0" translate="helpdesk.none"></span>

        <div ng-repeat="aggregatedLicense in helpdeskOrgCtrl.roomSystemsCard.aggregatedLicenses">
          <span>{{aggregatedLicense.displayName}}: </span>
          <span ng-if="!helpdeskOrgCtrl.licenseUsageReady">{{aggregatedLicense.totalVolume}} licenses</span>
          <span
            ng-if="helpdeskOrgCtrl.licenseUsageReady">{{aggregatedLicense.totalUsage || 0}} of {{aggregatedLicense.totalVolume}} in use ({{aggregatedLicense.usagePercentage}}%)</span>
          <span ng-if="aggregatedLicense.isTrial">| </span>
          <span class="label warning" ng-if="aggregatedLicense.isTrial" translate="helpdesk.trial"></span>
          <span ng-if="aggregatedLicense.isTrial && aggregatedLicense.trialExpiresInDays > 0">{{helpdeskOrgCtrl.daysLeftText(aggregatedLicense)}}</span>
            <span ng-if="aggregatedLicense.isTrial && aggregatedLicense.trialExpiresInDays == 0"
                  class="red">{{'helpdesk.licenseStatus.expired' |  translate}}</span>
          <span ng-if="aggregatedLicense.licenses.length > 1">|
            <a href
               ng-click="helpdeskOrgCtrl.showLicenseToggles[aggregatedLicense.key] = !helpdeskOrgCtrl.showLicenseToggles[aggregatedLicense.key]"
               translate="helpdesk.more"></a>
          </span>

          <div ng-repeat="license in aggregatedLicense.licenses" style="margin-left: 1rem;"
               collapse="!helpdeskOrgCtrl.showLicenseToggles[aggregatedLicense.key]">
            <span>{{'helpdesk.licenseStatus.' + (license.status | lowercase) | translate}}:</span>
            <span
              ng-if="helpdeskOrgCtrl.licenseUsageReady">{{license.usage || 0}} of {{license.volume}} in use</span>
            <span ng-if="!helpdeskOrgCtrl.licenseUsageReady">{{license.volume}} licenses</span>
            <span ng-if="license.isTrial">| </span>
            <span class="label warning" ng-if="license.isTrial" translate="helpdesk.trial"></span>
            <span
              ng-if="license.isTrial && license.trialExpiresInDays > 0">{{helpdeskOrgCtrl.daysLeftText(license)}}</span>
            <span ng-if="license.isTrial && license.trialExpiresInDays == 0"
                  class="red">{{'helpdesk.licenseStatus.expired' |  translate}}</span>
          </div>
        </div>
      </section>
      <footer class="org-card-footer">
        <span class="status right">
          <a ng-href="{{helpdeskOrgCtrl.statusPageUrl}}" target="_blank">
            <i class="icon icon-circle circle-status-icon" ng-class="helpdeskOrgCtrl.healthStatuses.room"></i>
          </a>
        </span>
      </footer>
    </article>
  </cs-card>

  <cs-card class="large header-bar cta" ng-show="helpdeskOrgCtrl.hybridServicesCard.entitled">
    <article>
      <header class="align-center">
        <div class="overview-header">
          <i class="icon icon-circle-data"></i>{{'helpdesk.hybridServices' | translate}}
        </div>
      </header>
      <section>
        <h5 translate="helpdesk.enabledServices"></h5>

        <div ng-repeat="hybridService in helpdeskOrgCtrl.hybridServicesCard.enabledHybridServices">
          <span>
            <i class="icon icon-circle circle-status-icon"
               ng-class="hybridService.status ? ('helpdesk-' + hybridService.status) : 'helpdesk-grey'"></i>
          </span>
          <span ng-if="hybridService.id != 'squared-fusion-uc'"
                translate="{{'hercules.serviceNames.' + hybridService.id}}"></span>
          <span ng-if="hybridService.id == 'squared-fusion-uc'"
                translate="hercules.serviceNames.squared-fusion-uc.full"></span>
        </div>
        <div
          ng-if="!helpdeskOrgCtrl.hybridServicesCard.enabledHybridServices || helpdeskOrgCtrl.hybridServicesCard.enabledHybridServices.length === 0">
          <span translate="helpdesk.none"></span>
        </div>

        <h5 translate="helpdesk.availableServices"></h5>

        <div
          ng-if="!helpdeskOrgCtrl.hybridServicesCard.availableHybridServices || helpdeskOrgCtrl.hybridServicesCard.availableHybridServices.length === 0">
          <span translate="helpdesk.none"></span>
        </div>
        <div ng-repeat="hybridService in helpdeskOrgCtrl.hybridServicesCard.availableHybridServices">
          <span ng-if="hybridService.id != 'squared-fusion-uc'"
                translate="{{'hercules.serviceNames.' + hybridService.id}}"></span>
          <span ng-if="hybridService.id == 'squared-fusion-uc'"
                translate="hercules.serviceNames.squared-fusion-uc.full"></span>
        </div>
      </section>
      <footer class="org-card-footer">
        <span class="status right">
          <a ng-href="{{helpdeskOrgCtrl.statusPageUrl}}" target="_blank">
            <span>
              <i class="icon icon-circle circle-status-icon right" ng-class="helpdeskOrgCtrl.healthStatuses.hybrid"></i>
            </span>
          </a>
        </span>
      </footer>
    </article>
  </cs-card>

  <cs-card class="large">
    <article>
      <header class="align-center">
        <div class="overview-header">
          <i class="icon icon-circle-user"></i>{{'helpdesk.users' | translate}}
        </div>
      </header>
      <section>
        <div>
          <div class="text-align-center large-number">{{helpdeskOrgCtrl.userCard.unlicensedUserCount}}</div>
          <div ng-if="helpdeskOrgCtrl.userCard.unlicensedUserCount != null" class="text-align-center">
            <span translate="helpdesk.unlicensedUsers"></span>
          </div>
          <hr>
          <span>
            <i class="icon icon-circle circle-status-icon"
               ng-class="helpdeskOrgCtrl.userCard.dirsyncEnabled ? 'helpdesk-green' : 'helpdesk-grey'"></i>
          </span>
          <span translate="helpdesk.dirSync"></span>
        </div>
        <div>
          <span>
            <i class="icon icon-circle circle-status-icon"
               ng-class="helpdeskOrgCtrl.userCard.ssoEnabled ? 'helpdesk-green' : 'helpdesk-grey'"></i>
          </span>
          <span translate="helpdesk.sso"></span>
        </div>
      </section>
      <footer></footer>
    </article>
  </cs-card>
</cs-card-layout>
