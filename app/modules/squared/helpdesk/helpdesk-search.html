<div class="helpdesk-landing centered">

  <h1 translate="helpdesk.helpdesk"></h1>

  <div class="typeahead-large" style="text-align: left;">
    <input id="searchInput" type="text"
           placeholder=""
           ng-model="helpdeskCtrl.searchString" ,
           ng-keypress="($event.which === 13) ? helpdeskCtrl.search() : 0"/>
    <button type="button" class="circle-small secondary icon icon-search" ng-click="helpdeskCtrl.search()" ng-disabled="helpdeskCtrl.searchString == ''" ></button>

    <div class="input-description">
      <p>
        <span translate="helpdesk.searchInputDescription"></span>
        <a href popover="{{'helpdesk.searchInfo' | translate}}"
           popover-placement="bottom">
          <span translate="helpdesk.searchCriteriaLink"></span>
        </a>
      </p>

      <div ng-if="helpdeskCtrl.currentSearch.orgFilter" class="helpdesk-tile">
        <span translate="helpdesk.searchingOrg"
              translate-value-name="{{helpdeskCtrl.currentSearch.orgFilter.displayName}}"></span>
        <i class="icon icon-close" ng-click="helpdeskCtrl.clearOrgFilter()"></i>
      </div>
    </div>
  </div>

  <div class="row full">
    <div class="medium-12 xlarge-10 xxlarge-8 centered columns no-top-margin">
      <div class="medium-4 columns"
           ng-if="helpdeskCtrl.searchingForUsers || helpdeskCtrl.currentSearch.userSearchResults || helpdeskCtrl.currentSearch.userSearchFailure">
        <h4 translate="helpdesk.users"></h4>

        <div ng-if="helpdeskCtrl.searchingForUsers">
          <span><i class="icon icon-spinner icon-2x"></i></span>

          <p translate="helpdesk.searchingPleaseWait"></p>
        </div>
        <div ng-if="helpdeskCtrl.currentSearch.userSearchFailure">
          <p class="helpdesk-red">{{helpdeskCtrl.currentSearch.userSearchFailure}}</p>
        </div>
        <div
          ng-if="!helpdeskCtrl.searchingForUsers && helpdeskCtrl.currentSearch.userSearchResults.length == 0">
          <p translate="helpdesk.noSearchHits"></p>
        </div>

        <cs-card-layout ng-if="helpdeskCtrl.currentSearch.userSearchResults.length > 0">
          <cs-card class="full" ng-repeat="user in helpdeskCtrl.currentSearch.userSearchResults">
            <article>
              <header>
                <h5><a ui-sref-active="active" ui-sref="helpdesk.user({user:user})">{{user.displayName}}</a></h5>
              </header>
              <section class="card-section">
                <div><span>{{user.userName}}</span></div>
                <div ng-repeat="number in user.phoneNumbers">
                  <span>{{number.value}} ({{'helpdesk.' + number.type | translate}})</span>
                </div>
                <div ng-if="user.org"><span>{{user.org.displayName}}</span></div>
              </section>
            </article>
          </cs-card>
        </cs-card-layout>
      </div>

      <div class="medium-4 columns"
           ng-if="helpdeskCtrl.searchingForOrgs || helpdeskCtrl.currentSearch.orgSearchResults || helpdeskCtrl.currentSearch.orgSearchFailure">

        <h4 translate="helpdesk.customers"></h4>

        <div ng-if="helpdeskCtrl.searchingForOrgs">
          <span><i class="icon icon-spinner icon-2x"></i></span>

          <p translate="helpdesk.searchingPleaseWait"></p>
        </div>
        <div ng-if="helpdeskCtrl.currentSearch.orgSearchFailure">
          <p class="helpdesk-red">{{helpdeskCtrl.currentSearch.orgSearchFailure}}</p>
        </div>
        <div
          ng-if="!helpdeskCtrl.searchingForOrgs && helpdeskCtrl.currentSearch.orgSearchResults.length == 0">
          <p translate="helpdesk.noSearchHits"></p>
        </div>

        <cs-card-layout ng-if="helpdeskCtrl.currentSearch.orgSearchResults.length > 0">
          <cs-card class="full" ng-repeat="org in helpdeskCtrl.currentSearch.orgSearchResults">
            <article>
              <header>
                <h5>
                  <a ui-sref="helpdesk.org({org:org})">{{org.displayName}}</a>
                  <a href class="right" ng-click="helpdeskCtrl.setOrgFilter(org)"><i class="icon icon-search"></i></a>
                </h5>
              </header>
              <section class="card-section">
              </section>
            </article>
          </cs-card>
        </cs-card-layout>
      </div>

      <div class="medium-4 columns"
           ng-if="helpdeskCtrl.searchingForUsers || helpdeskCtrl.currentSearch.userSearchResults || helpdeskCtrl.currentSearch.userSearchFailure">
        <h4 translate="helpdesk.devices"></h4>

        <p>Device search is not supported yet.</p>
      </div>

    </div>
  </div>
</div>
