<div class="row support-row">
  <div class="page-title col-xs-12">
    <span class="title">{{'supportPage.title' | translate}}</span>
  </div>
</div>
<div class="row support-row">
  <div class="search-panel col-xs-12 col-md-8">
      <div id="listLogs">
        <span class="search-title" id="subtitleLogs" translate="supportPage.subtitleLogs">
        </span>
      </div>
    <div class="search-panel-input">
      <form role="form">
        <div class="form-group">
          <input class="form-control support_input" type="text" id="logsearchfield" ng-model="input.search" placeholder=''/>
        </div>

        <div class="form-group search-button-log">
          <button id="logSearchBtn" class="btn btn-primary pull-right" ng-click="getLogs()" data-loading-text="<i class='icon icon-spinner'></i>"><span translate="supportPage.listlogsbtn"></span></button>
        </div>
      </form>
    </div>
  </div>
  <div class="col-xs-12 col-md-4">
    <div class="row support-row">
      <div class="col-xs-12 support-card">
        <div class="health-card" ng-show="healthyStatus === true" ng-click="toggleSystem()">
          <span class="icon icon-check healthy-check"></span>
          <span class="healthy" translate="supportPage.operational"></span>
        </div>
        <div class="health-card" ng-show="healthyStatus === false" ng-click="toggleSystem()">
          <span class="icon icon-close error-check"></span>
          <span class="error-msg" translate="supportPage.error"></span>
        </div>
        <section class="monitoring-panel systems-detail" ng-show="showSystemDetails">
          <div ng-repeat="health in healthMetrics">
            <a ng-href="{{statusPageUrl}}" target="_blank">
              <div ng-class="{true:'green', false:'red'}[health.status==='operational']" class="monitoring-cell" id="{{health.name}}">
                <i class="fa fa-circle"></i>&nbsp;&nbsp;<span>{{health.name}}</span>
              </div>
            </a>
          </div>
        </section>
      </div>
    </div>
    <div class="row support-row">
      <div class="col-xs-12 support-card">
        <span class="support-info" translate="supportPage.supportResources"></span>
        <div class="display-link" ng-click="toggleSupport()" ng-show="showSupportDetails === false" href="">
          <span translate="supportPage.showDetails"></span>
        </div>
        <div class="display-link" ng-click="toggleSupport()" ng-show="showSupportDetails === true" href="">
          <span translate="supportPage.hideDetails"></span>
        </div>
        <div ng-show="showSupportDetails === true">
          <p class="bucket-header support-header header-section" translate="supportPage.problemReports"></p>
          <p class="support-dsc">{{problemContent | translate}} {{problemHandler | translate}}.</p>
          <span class="support-dsc" translate="supportPage.reportingUrl"></span>
            <a ng-show="reportingUrl === null" href="" translate="supportPage.sendFeedback" ng-click="sendFeedback()"></a>
            <a ng-show="reportingUrl !== null" href="{{reportingUrl}}" target="_blank">{{reportingUrl}}</a>
          <p class="bucket-header support-header-help header-section" translate="supportPage.help"></p>
          <p class="support-dsc">{{helpContent | translate }} {{helpHandler | translate}}.</p>
          <p class="support-dsc">{{'supportPage.helpUrl' | translate}} <a href="{{helpUrl}}" target="_blank">{{helpUrl}}</a></p>
          <p class="bucket-header support-header-help header-section" translate="supportPage.faqs"></p>
          <p class="support-dsc"><a href="{{ssoUrl}}" target="_blank">{{'supportPage.sso' | translate}}</a></p>
          <p class="support-dsc"><a href="{{rolesUrl}}" target="_blank">{{'supportPage.roles' | translate}}</a></p>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="logs-panel" class="col-md-12 col-sm-12" ng-hide="callInfoActive">
  <div id="userSupport" class="customer-list">
    <div class="page-header row">
      <label ng-show="userLogs.length === 0 || !userLogs"><span id="noResults" translate="supportPage.noResults"></label>
      <div id="supportTable" gridscrollbar class="gridStyle col-md-12" ng-grid="gridOptions"></div>
    </div>
  </div>
</div>

<div class="panel panel-default call-info-panel" id="call-info-panel" ng-show="callInfoActive">
  <div class="panel-heading panel-heading-default">
      <div class="panel-title panel-title-default">
        <strong id="subTitleCallInfo" translate="supportPage.subTitleCallInfo"></strong>
        <strong>{{emailAddress}}</strong>
        <i id="closeCallInfo" ng-click="closeCallInfo()" class="fa fa-times add-user-close pull-right"></i>
      </div>
  </div>
  <div class="panel-body">
    <label ng-show="!getPending && (logInfo.length === 0 || !logInfo)"><span id="noResults" translate="supportPage.noResults"></label>
    <div class="center" ng-show="getPending && (logInfo.length === 0 || !logInfo)">
      <i class='icon icon-spinner'></i>
    </div>
    <table class="table" ng-show="logInfo.length !== 0">
      <thead>
        <tr>
          <th><span translate="supportPage.locusId"></span> : {{logInfo[0].locusId}}</th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="info in logInfo">
          <td>
            <table class="table">
              <thead>
                <tr>
                  <td><span translate="supportPage.locusCallStartTimeH"></span></td>
                  <td><span translate="supportPage.attributes"></span></td>
                  <td><span translate="supportPage.value"></span></td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>{{info.locusCallStartTime}}</td>
                  <td><span translate="supportPage.userId"></span></td>
                  <td>
                    <a ng-click="downloadFlow(info.graphUserIdUrl)">
                      {{info.userId}}
                    </a>
                    <a href="{{info.graphUserIdUrl}}">
                      <i class="fa fa-download"></i>
                    </a>
                  </td>
                </tr>
                <tr>
                  <td></td>
                  <td><span translate="supportPage.emailAddress"></span></td>
                  <td>{{info.emailAddress}}</td>
                </tr>
                <tr>
                  <td></td>
                  <td><span translate="supportPage.orgId"></span></td>
                  <td>{{info.orgId}}</td>
                </tr>
                <tr>
                  <td></td>
                  <td><span translate="supportPage.locusId"></span></td>
                  <td>
                    <a ng-click="downloadFlow(info.graphLocusIdUrl)">
                      {{info.locusId}}
                    </a>
                    <a href="{{info.graphLocusIdUrl}}">
                      <i class="fa fa-download"></i>
                    </a>
                  </td>
                </tr>
                <tr>
                  <td></td>
                  <td><span translate="supportPage.locusCallStartTime"></span></td>
                  <td>{{info.locusCallStartTime}}</td>
                </tr>
                <tr>
                  <td></td>
                  <td><span translate="supportPage.deviceId"></span></td>
                  <td>{{info.deviceId}}</td>
                </tr>
                <tr>
                  <td></td>
                  <td><span translate="supportPage.isGroupCall"></span></td>
                  <td>{{info.isGroupCall}}</td>
                </tr>
                <tr>
                  <td></td>
                  <td><span translate="supportPage.callDuration"></span></td>
                  <td>{{info.callDuration}}</td>
                </tr>
                <tr>
                  <td></td>
                  <td><span translate="supportPage.userAgent"></span></td>
                  <td>{{info.usrAgent}}</td>
                </tr>
                <tr>
                  <td></td>
                  <td><span translate="supportPage.networkName"></span></td>
                  <td>{{info.networkName}}</td>
                </tr>
                <tr>
                  <td></td>
                  <td><span translate="supportPage.networkType"></span></td>
                  <td>{{info.networkType}}</td>
                </tr>
                <tr>
                  <td></td>
                  <td><span translate="supportPage.trackingId"></span></td>
                  <td>
                    <a ng-click="downloadFlow(info.graphTrackingIdUrl)">
                      {{info.trackingId}}
                    </a>
                    <a href="{{info.graphTrackingIdUrl}}">
                      <i class="fa fa-download"></i>
                    </a>
                  </td>
                </tr>
                <tr>
                  <td></td>
                  <td><span translate="supportPage.audioStart"></span></td>
                  <td>{{info.audioStart}}</td>
                </tr>
                <tr>
                  <td></td>
                  <td><span translate="supportPage.audioJitter"></span></td>
                  <td><span translate="supportPage.rx"></span> : {{info.audioRxJitter}} <span translate="supportPage.tx"></span> : {{info.audioTxJitter}}</td>
                </tr>
                <tr>
                  <td></td>
                  <td><span translate="supportPage.audioLossRatio"></span></td>
                  <td><span translate="supportPage.rx"></span> : {{info.audioRxLossRatio}} <span translate="supportPage.tx"></span> : {{info.audioTxLossRatio}}</td>
                </tr>
                <tr>
                  <td></td>
                  <td><span translate="supportPage.videoStart"></span></td>
                  <td>{{info.videoStart}}</td>
                </tr>
                <tr>
                  <td></td>
                  <td><span translate="supportPage.videoJitter"></span></td>
                  <td><span translate="supportPage.rx"></span> : {{info.videoRxJitter}} <span translate="supportPage.tx"></span> : {{info.videoTxJitter}}</td>
                </tr>
                <tr>
                  <td></td>
                  <td><span translate="supportPage.videoLossRatio"></span></td>
                  <td><span translate="supportPage.rx"></span> : {{info.videoRxLossRatio}} <span translate="supportPage.tx"></span> : {{info.videoTxLossRatio}}</td>
                </tr>
                <tr ng-show="info.errorCode === 0">
                  <td></td>
                  <td><span translate="supportPage.errorCode"></span></td>
                  <td>0</td>
                </tr>
                <tr ng-show="info.errorCode === 1">
                  <td></td>
                  <td><span translate="supportPage.errorComponent"></span></td>
                  <td>{{info.component}}</td>
                </tr>
                <tr ng-show="info.errorCode === 1">
                  <td></td>
                  <td><span translate="supportPage.errorMessage"></span></td>
                  <td>{{info.errMessage}}</td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<div class="panel panel-default call-info-panel" id="call-flow-panel" ng-show="callFlowActive">
  <div class="panel-heading panel-heading-default">
      <div class="panel-title panel-title-default">
        <strong id="subTitleCallFlow" translate="supportPage.subTitleCallFlow"></strong>
        <i id="closeCallFlow" ng-click="closeCallInfo()" class="fa fa-times add-user-close pull-right"></i>
      </div>
  </div>
  <div class="panel-body">
    <a><img style="width: 100%" ng-src="{{callFlowUrl}}"></a>
  </div>
</div>
